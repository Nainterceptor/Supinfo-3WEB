<!Doctype html>
<html>
<head>
    <title>Chat</title>
    <style>
        .chat {
            display: none;
        }
    </style>
</head>
<body>
<div class="connection">
    <form id="connection">
        <input type="text" id="username" placeholder="Username"/>
        <input type="submit" value="Connect !"/>
    </form>
</div>

<div class="chat">
    <form id="messageForm">
        <input type="text" id="message" placeholder="Message..."/>
        <input type="submit" value="Send !"/>
    </form>
    <ul id="messages">
    </ul>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="jquery-2.1.1.min.js"></script>
<script>
    jQuery(document).ready(function () {
        var socket = io.connect('http://localhost');

        jQuery('#connection').on('submit', function (event) {
            event.preventDefault();

            var username = jQuery('#username').val();
            if (username == '') return;
            socket.emit('join', username);

            jQuery('.connection').hide();
            jQuery('.chat').show();

            jQuery('#messageForm').on('submit', function (event) {
                event.preventDefault();

                var message = jQuery('#message').val();
                if (message == '') return;
                socket.emit('message', {name: username, message: message});
            });

            socket.on('join', function (data) {
                var li = jQuery('<li>').text(data + ' joined !');

                jQuery('#messages').prepend(li);
            });

            socket.on('message', function (data) {
                var li = jQuery('<li>').text(data.name + ' : ' + data.message);

                jQuery('#messages').prepend(li);
            });

        });
    });
</script>
</body>
</html>